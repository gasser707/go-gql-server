enum Role {
    ADMIN
    USER
    MODERATOR
}

type User {
    id: ID!
    username: String!
    email: String!
    role: Role!
    bio: String!
	  avatar: String!
    joined: Time
}

type Sale {
    id: ID!
    image: Image!
    buyer: User!
    seller: User!
    time: Time
}


type Image {
    id: ID!
    title: String!
    description: String!
    user: User!
    labels: [String!]!
    url: String!
    private: Boolean!
    forSale: Boolean!
    created: Time
}

type Query {
    images(input: ImageFilterInput): [Image!]! @Authorize
    users(input: UserFilterInput): [User!]! @Authorize
}

input ImageFilterInput {
  id: ID
  userId: ID
  title: String
  description: String
  labels: [String!]
  private: Boolean
  forSale: Boolean
}

input UserFilterInput {
    id: ID
    username: String
    email: String
    role: Role
    bio: String
}


input NewUserInput {
  username: String!
  email: String!
  password: String!
  bio: String!
  avatar: String!
}

input UpdateUserInput {
    id: ID!
    username: String
    email: String
    bio: String
    avatar: String
}

input NewImageInput {
  title: String!
  description: String!
  labels: [String!]!
  url: String!
  private: Boolean!
  forSale: Boolean!
}

input UpdateImageInput {
  id: ID!
  title: String
  description: String
  labels: [String!]
  url: String
  private: Boolean
  forSale: Boolean
}

input BuyImageInput {
  imageId: ID!
}

input DeleteImageInput{
  id: ID!
}

input LoginInput {
  email: String!
  password: String!
}

type Mutation{
  registerUser(input: NewUserInput!): User! 
  updateUser(input: UpdateUserInput!): User! @Authorize @IsSelf
  uploadImages(input: [NewImageInput!]!): [Image!]! @Authorize @IsOwnImage
  deleteImages(input: [DeleteImageInput!]!): Boolean! @Authorize @IsOwnImage
  updateImage(input: UpdateImageInput!): Image! @Authorize @IsOwnImage
  buyImage(input: BuyImageInput): Sale! @Authorize
  login(input: LoginInput!): Boolean!
  logout(input: Boolean ):Boolean! @Authorize
}

scalar Time


directive @IsOwnImage on FIELD_DEFINITION
directive @IsSelf on FIELD_DEFINITION
directive @Authorize on FIELD_DEFINITION

